d_null <- read.csv("Z:/Documents/GitHub/Genetic-Architecture-in-SLiM/src/Cluster_jobs/pilot_runs/Output/out_8T_null_means", header = F)
setwd("Z:/Documents/GitHub/Genetic-Architecture-in-SLiM/src/R/pilot_runs")
d_null <- read.csv("Z:/Documents/GitHub/Genetic-Architecture-in-SLiM/src/Cluster_jobs/pilot_runs/Output/out_8T_null_means", header = F)
setwd("Z:/Documents/GitHub/Genetic-Architecture-in-SLiM/src/Cluster_jobs/pilot_runs/Output")
d_null <- read.csv("out_8T_null_means", header = F)
d_null <- read.csv("Z:/Documents/GitHub/Genetic-Architecture-in-SLiM/src/Cluster_jobs/pilot_runs/Output/out_8T_null_means.csv", header = F)
setwd("Z:/Documents/GitHub/Genetic-Architecture-in-SLiM/src/R/pilot_runs")
d_null <- read.csv("Z:/Documents/GitHub/Genetic-Architecture-in-SLiM/src/Cluster_jobs/pilot_runs/Output/out_8T_null_means.csv", header = F)
View(d_null)
d_null$V1 == 150000
d_null[d_null$V1 == 150000]
d_null[,d_null$V1 == 150000]
d_null[, d_null$V1 == 150000]
d_null[d_null$V1 == 150000, ]
View(d_null)
cov_names <- for (i in c(0, 1, 2, 3, 4, 5, 6, 7))
for (j in c(0, 1, 2, 3, 4, 5, 6, 7))
paste(c("cov_", i, j))
if (i == j)
cov_names[match(i, c(0, 1, 2, 3, 4, 5, 6, 7))] <- -1
cov_names <- for (i in c(0, 1, 2, 3, 4, 5, 6, 7)) {
for (j in c(0, 1, 2, 3, 4, 5, 6, 7)) {
paste(c("cov_", i, j))
if (i == j)
cov_names[match(i, c(0, 1, 2, 3, 4, 5, 6, 7))] <- -1
}
}
for (i in c(0, 1, 2, 3, 4, 5, 6, 7)) {
for (j in c(0, 1, 2, 3, 4, 5, 6, 7)) {
cov_names[match(i, c(0, 1, 2, 3, 4, 5, 6, 7))] <- paste(c("cov_", i, j))
if (i == j)
cov_names[match(i, c(0, 1, 2, 3, 4, 5, 6, 7))] <- -1
}
}
for (i in c(0, 1, 2, 3, 4, 5, 6, 7)) {
for (j in c(0, 1, 2, 3, 4, 5, 6, 7)) {
cov_names[match(i, c(0, 1, 2, 3, 4, 5, 6, 7))] <- paste(c("cov_", as.character(i), as.character(j)))
if (i == j)
cov_names[match(i, c(0, 1, 2, 3, 4, 5, 6, 7))] <- -1
}
}
rm(cov_names)
01:07
names(d_null[1:7]) <- c("gen", "seed", "modelindex", "rsd", "rwide", "delmu", "nloci")
names(d_null[8:36]) <-  c(paste0(c("cov_0", 1:7)), paste0(c("cov_1", 2:7)), paste0(c("cov_2", 3:7)), paste0(c("cov3", 4:7)), paste0(c("cov4", 5:7)), paste0(c("cov5", 6:7)), paste0(c("cov6", 7)))
c(paste0(c("cov_0", 1:7)), paste0(c("cov_1", 2:7)), paste0(c("cov_2", 3:7)), paste0(c("cov3", 4:7)), paste0(c("cov4", 5:7)), paste0(c("cov5", 6:7)), paste0(c("cov6", 7)))
paste0(c("cov_0", 1:7)), paste0(c("cov_1", 2:7)), paste0(c("cov_2", 3:7)), paste0(c("cov_3", 4:7)), paste0(c("cov_4", 5:7)), paste0(c("cov_5", 6:7)), paste0(c("cov_6", 7))
paste0(c("cov_0", 1:7), paste0(c("cov_1", 2:7)), paste0(c("cov_2", 3:7)), paste0(c("cov_3", 4:7)), paste0(c("cov_4", 5:7)), paste0(c("cov_5", 6:7)), paste0(c("cov_6", 7))
)
c("cov_0", 1:7), paste0(c("cov_1", 2:7)), paste0(c("cov_2", 3:7)), paste0(c("cov_3", 4:7)), paste0(c("cov_4", 5:7)), paste0(c("cov_5", 6:7)), paste0(c("cov_6", 7))
c("cov_0", 1:7, paste0(c("cov_1", 2:7)), paste0(c("cov_2", 3:7)), paste0(c("cov_3", 4:7)), paste0(c("cov_4", 5:7)), paste0(c("cov_5", 6:7)), paste0(c("cov_6", 7))
)
paste("cov0_", 1:7)
paste("cov_0", 1:7, sep = "")
paste0("cov_0", 1:7)
c(paste0("cov_0", 1:7), paste0("cov_1", 2:7))
length(c(paste0("cov_0", 1:7), paste0("cov_1", 2:7), paste0("cov_2", 3:7), paste0("cov_3", 4:7), paste0("cov_4", 5:7), paste0("cov_5", 6:7), paste0("cov_6", 7))
)
c(paste0("cov_0", 1:7), paste0("cov_1", 2:7), paste0("cov_2", 3:7), paste0("cov_3", 4:7), paste0("cov_4", 5:7), paste0("cov_5", 6:7), paste0("cov_6", 7))
# pleiocov terms
names(d_null[8:35]) <-  c(paste0("pleiocov_0", 1:7), paste0("pleiocov_1", 2:7), paste0("pleiocov_2", 3:7), paste0("pleiocov_3", 4:7), paste0("pleiocov_4", 5:7), paste0("pleiocov_5", 6:7), paste0("pleiocov_6", 7))
names(d_null[36]) <- "Ne"
names(d_null[37:44]) <- paste0("mean", 0:7)
names(d_null[45:52]) <- paste0("var", 0:7)
names(d_null[53:80]) <- c(paste0("phenocov_0", 1:7), paste0("phenocov_1", 2:7), paste0("phenocov_2", 3:7), paste0("phenocov_3", 4:7), paste0("phenocov_4", 5:7), paste0("phenocov_5", 6:7), paste0("phenocov_6", 7))
names(d_null[81:108]) <- c(paste0("phenocor_0", 1:7), paste0("phenocor_1", 2:7), paste0("phenocor_2", 3:7), paste0("phenocor_3", 4:7), paste0("phenocor_4", 5:7), paste0("phenocor_5", 6:7), paste0("phenocor_6", 7))
names(d_null[109:118]) <- paste0("H_chr", 0:9)
View(d_null)
names(d_null)[36] <- "Ne"
names(d_null)[37:44] <- paste0("mean", 0:7)
names(d_null)[45:52] <- paste0("var", 0:7)
names(d_null)[53:80] <- c(paste0("phenocov_0", 1:7), paste0("phenocov_1", 2:7), paste0("phenocov_2", 3:7), paste0("phenocov_3", 4:7), paste0("phenocov_4", 5:7), paste0("phenocov_5", 6:7), paste0("phenocov_6", 7))
names(d_null)[81:108] <- c(paste0("phenocor_0", 1:7), paste0("phenocor_1", 2:7), paste0("phenocor_2", 3:7), paste0("phenocor_3", 4:7), paste0("phenocor_4", 5:7), paste0("phenocor_5", 6:7), paste0("phenocor_6", 7))
names(d_null)[109:118] <- paste0("H_chr", 0:9)
View(d_null)
names(d_null)[1:7]<- c("gen", "seed", "modelindex", "rsd", "rwide", "delmu", "nloci")
# pleiocov terms
names(d_null)[8:35] <-  c(paste0("pleiocov_0", 1:7), paste0("pleiocov_1", 2:7), paste0("pleiocov_2", 3:7), paste0("pleiocov_3", 4:7), paste0("pleiocov_4", 5:7), paste0("pleiocov_5", 6:7), paste0("pleiocov_6", 7))
names(d_null)[36] <- "Ne"
names(d_null)[37:44] <- paste0("mean", 0:7)
names(d_null)[45:52] <- paste0("var", 0:7)
names(d_null)[53:80] <- c(paste0("phenocov_0", 1:7), paste0("phenocov_1", 2:7), paste0("phenocov_2", 3:7), paste0("phenocov_3", 4:7), paste0("phenocov_4", 5:7), paste0("phenocov_5", 6:7), paste0("phenocov_6", 7))
names(d_null)[81:108] <- c(paste0("phenocor_0", 1:7), paste0("phenocor_1", 2:7), paste0("phenocor_2", 3:7), paste0("phenocor_3", 4:7), paste0("phenocor_4", 5:7), paste0("phenocor_5", 6:7), paste0("phenocor_6", 7))
names(d_null)[109:118] <- paste0("H_chr", 0:9)
d_sbstfinal_null <- d_null[d_null$gen == 150000,]
View(d_sbstfinal_null)
vars <- d_sbstfinal_null[, 45:52]
covs <- d_sbstfinal_null[, 53:80]
diag(vars)
View(vars)
View(d_null)
View(d_sbstfinal_null)
d_sbstfinal_null <- d_null[d_null$gen == 150000 & d_bull$modelindex == 2,]
d_sbstfinal_null <- d_null[d_null$gen == 150000 & d_null$modelindex == 2,]
vars <- d_sbstfinal_null[, 45:52]
covs <- d_sbstfinal_null[, 53:80]
diag(vars)
diag(mean(vars))
mean_vars
mean(vars)
View(vars)
rm(vars)
rm(covs)
rm(c(i, j))
rm(list = c(i, j))
rm(list = (i, j))
rm(i)
rm(j)
d_sbstfinal_null <- d_null[d_null$gen == 150000,]
select(d_sbstfinal_null, gen, seed, modelindex, d_sbstfinal_null[c(37:44, 45:52, 53:80)],)
library(dplyr)
select(d_sbstfinal_null, gen, seed, modelindex, d_sbstfinal_null[c(37:44, 45:52, 53:80)],)
d_sbstfinal_null <- as.tibble(d_null[d_null$gen == 150000,])
d_sbstfinal_null <- as_tibble(d_null[d_null$gen == 150000,])
select(d_sbstfinal_null, gen, seed, modelindex, d_sbstfinal_null[c(37:44, 45:52, 53:80)],)
select(d_sbstfinal_null, gen, seed, modelindex, phenotype0, phenotype1)
select(d_sbstfinal_null, gen, seed, modelindex, mean0, mean1)
select(d_sbstfinal_null, gen, seed, modelindex, paste0("mean", 0:7))
select(d_sbstfinal_null, gen, seed, modelindex, paste0("mean", 0:7), paste0("var", 0:7), c(paste0("phenocov_0", 1:7), paste0("phenocov_1", 2:7), paste0("phenocov_2", 3:7), paste0("phenocov_3", 4:7), paste0("phenocov_4", 5:7), paste0("phenocov_5", 6:7), paste0("phenocov_6", 7)))
select(d_sbstfinal_null, gen, seed, modelindex, paste0("var", 0:7), c(paste0("phenocov_0", 1:7), paste0("phenocov_1", 2:7), paste0("phenocov_2", 3:7), paste0("phenocov_3", 4:7), paste0("phenocov_4", 5:7), paste0("phenocov_5", 6:7), paste0("phenocov_6", 7)))
d_null_mat <- select(d_sbstfinal_null, gen, seed, modelindex, paste0("var", 0:7), c(paste0("phenocov_0", 1:7), paste0("phenocov_1", 2:7), paste0("phenocov_2", 3:7), paste0("phenocov_3", 4:7), paste0("phenocov_4", 5:7), paste0("phenocov_5", 6:7), paste0("phenocov_6", 7)))
std.error <- function(x){
sd(x)/sqrt(length(x))
}
d_null_mat <- d_null_mat %>%
group_by(gen, seed, modelindex) %>%
summarise_all(list(groupmean = mean, se = std.error))
View(d_null_mat)
std.error <- function(x){
n <- length(x)
sd <- sd(x)
sd/sqrt(n)
}
std.error(c(1:8))
d_null_mat <- d_null_mat %>%
group_by(gen, modelindex) %>%
summarise_all(list(groupmean = mean, se = std.error))
View(d_null_mat)
d_null_mat <- select(d_sbstfinal_null, gen, seed, modelindex, paste0("var", 0:7), c(paste0("phenocov_0", 1:7), paste0("phenocov_1", 2:7), paste0("phenocov_2", 3:7), paste0("phenocov_3", 4:7), paste0("phenocov_4", 5:7), paste0("phenocov_5", 6:7), paste0("phenocov_6", 7)))
d_null_mat <- d_null_mat %>%
group_by(gen, modelindex) %>%
summarise_all(list(groupmean = mean, se = std.error))
View(d_null_mat)
d_null_mat <- select(d_sbstfinal_null, gen, seed, modelindex, paste0("var", 0:7), c(paste0("phenocov_0", 1:7), paste0("phenocov_1", 2:7), paste0("phenocov_2", 3:7), paste0("phenocov_3", 4:7), paste0("phenocov_4", 5:7), paste0("phenocov_5", 6:7), paste0("phenocov_6", 7)))
?diag()
dat_to_mat <- function(dat) {
dat <- as.vector(t(dat))
vars <- dat[4:11]
covs <- dat[12:39]
M <- matrix(data = c(
vars[1], covs[1:8],
covs[1], vars[2], covs[2:8],
covs[1:2], vars[3], covs[3:8],
covs[1:3], vars[4], covs[4:8],
covs[1:4], vars[5], covs[5:8],
covs[1:5], vars[6], covs[6:8],
covs[1:6], vars[7], covs[7:8],
covs[1:7], vars[8], covs[8]), ncol = 8
)
M
}
dat_to_mat(d_null_mat[1,])
dat_to_mat <- function(dat) {
dat <- as.vector(t(dat))
vars <- dat[4:11]
covs <- dat[12:39]
M <- matrix(data = c(
vars[1], covs[1:8],
covs[1], vars[2], covs[2:8],
covs[1:2], vars[3], covs[3:8],
covs[1:3], vars[4], covs[4:8],
covs[1:4], vars[5], covs[5:8],
covs[1:5], vars[6], covs[6:8],
covs[1:6], vars[7], covs[7:8],
covs[1:7], vars[8], covs[8]), ncol = 8, bycol = T
)
M
}
dat_to_mat(d_null_mat[1,])
dat_to_mat <- function(dat) {
dat <- as.vector(t(dat))
vars <- dat[4:11]
covs <- dat[12:39]
M <- matrix(data = c(
vars[1], covs[1:8],
covs[1], vars[2], covs[2:8],
covs[1:2], vars[3], covs[3:8],
covs[1:3], vars[4], covs[4:8],
covs[1:4], vars[5], covs[5:8],
covs[1:5], vars[6], covs[6:8],
covs[1:6], vars[7], covs[7:8],
covs[1:7], vars[8], covs[8]), ncol = 8, by.col = T
)
M
}
dat_to_mat(d_null_mat[1,])
dat_to_mat <- function(dat) {
dat <- as.vector(t(dat))
vars <- dat[4:11]
covs <- dat[12:39]
M <- matrix(data = c(
vars[1], covs[1:8],
covs[1], vars[2], covs[2:8],
covs[1:2], vars[3], covs[3:8],
covs[1:3], vars[4], covs[4:8],
covs[1:4], vars[5], covs[5:8],
covs[1:5], vars[6], covs[6:8],
covs[1:6], vars[7], covs[7:8],
covs[1:7], vars[8], covs[8]), ncol = 8, byrow = T
)
M
}
dat_to_mat(d_null_mat[1,])
dat_to_mat <- function(dat) {
dat <- as.vector(t(dat))
vars <- dat[4:11]
covs <- dat[12:39]
M <- matrix(data = c(
vars[1], covs[1:8],
covs[1], vars[2], covs[2:8],
covs[1:2], vars[3], covs[3:8],
covs[1:3], vars[4], covs[4:8],
covs[1:4], vars[5], covs[5:8],
covs[1:5], vars[6], covs[6:8],
covs[1:6], vars[7], covs[7:8],
covs[1:7], vars[8], covs[8]), nrow = 8, byrow = T
)
M
}
dat_to_mat(d_null_mat[1,])
dat_to_mat <- function(dat) {
dat <- as.vector(t(dat))
vars <- dat[4:11]
covs <- dat[12:39]
M <- matrix(data = c(
vars[1], covs[1:7],
covs[1], vars[2], covs[8:13],
covs[c(2,8)], vars[3], covs[14:18],
covs[c(3, 9, 14)], vars[4], covs[19:22],
covs[c(4, 10, 15, 19)], vars[5], covs[23:25],
covs[c(5, 11, 16, 20, 23)], vars[6], covs[26:27],
covs[c(6, 12, 17, 21, 24, 26)], vars[7], covs[28],
covs[c(7, 13, 18, 22, 25, 27, 28)], vars[8]), nrow = 8, byrow = T
)
M
}
dat_to_mat(d_null_mat[1,])
?list
dat_to_mat <- function(dat) {
dat <- as.vector(t(dat))
vars <- dat[4:11]
covs <- dat[12:39]
M <- matrix(data = c(
vars[1], covs[1:7],
covs[1], vars[2], covs[8:13],
covs[c(2,8)], vars[3], covs[14:18],
covs[c(3, 9, 14)], vars[4], covs[19:22],
covs[c(4, 10, 15, 19)], vars[5], covs[23:25],
covs[c(5, 11, 16, 20, 23)], vars[6], covs[26:27],
covs[c(6, 12, 17, 21, 24, 26)], vars[7], covs[28],
covs[c(7, 13, 18, 22, 25, 27, 28)], vars[8]), nrow = 8, byrow = T
)
M
}
mat_gen <- function(dat) {
dat <- split(as.matrix(dat))
mat_out <- array(dim = 8*n)
mat_out <- lapply(dat, dat_to_mat)
}
mat_gen(d_null_mat)
?split
mat_gen <- function(dat) {
dat <- split(as.matrix(dat), row(dat))
mat_out <- array(dim = 8*n)
mat_out <- lapply(dat, dat_to_mat)
}
mat_gen(d_null_mat)
mat_gen <- function(dat) {
dat <- split(as.matrix(dat), row(dat))
mat_out <- lapply(dat, dat_to_mat)
}
mat_gen(d_null_mat)
mat_gen <- function(dat) {
dat <- split(as.matrix(dat), row(dat))
lapply(dat, dat_to_mat)
}
mat_gen <- function(dat) {
dat <- split(as.matrix(dat), row(dat))
mat_out <- lapply(dat, dat_to_mat)
mat_out
}
mat_gen(d_null_mat)
G_null_mat <- mat_gen(d_null_mat)
View(G_null_mat)
dat_to_mat(d_null_mat[1,])
dat_to_mat(d_null_mat[1,])
mat_gen <- function(dat) {
dat <- split(as.matrix(dat), row(dat))
mat_out <- lapply(dat, dat_to_mat)
names(mat_out) <- paste0(dat$modelindex, "_", dat$seed)
}
G_null_mat <- mat_gen(d_null_mat)
G_null_mat
mat_gen <- function(dat) {
dat <- split(as.matrix(dat), row(dat))
mat_out <- lapply(dat, dat_to_mat)
}
mat_gen <- function(dat) {
dat <- split(as.matrix(dat), row(dat))
mat_out <- lapply(dat, dat_to_mat)
names(mat_out) <- paste0(dat$modelindex, "_", dat$seed)
mat_out
}
G_null_mat <- mat_gen(d_null_mat)
View(G_null_mat)
mat_gen <- function(dat) {
dat <- split(as.matrix(dat), row(dat))
mat_out <- lapply(dat, dat_to_mat)
names(mat_out) <- paste0(c(dat$modelindex, "_", dat$seed))
mat_out
}
G_null_mat <- mat_gen(d_null_mat)
View(G_null_mat)
mat_gen <- function(dat) {
dat <- split(as.matrix(dat), row(dat))
mat_out <- lapply(dat, dat_to_mat)
names(mat_out) <- paste0(as_character(dat$modelindex), "_", as_character(dat$seed))
mat_out
}
G_null_mat <- mat_gen(d_null_mat)
mat_gen <- function(dat) {
dat <- split(as.matrix(dat), row(dat))
mat_out <- lapply(dat, dat_to_mat)
names(mat_out) <- paste0(as.character(dat$modelindex), "_", as.character(dat$seed))
mat_out
}
G_null_mat <- mat_gen(d_null_mat)
View(G_null_mat)
mat_gen <- function(dat) {
dat <- split(as.matrix(dat), row(dat))
lapply(dat, dat_to_mat)
}
G_null_mat <- mat_gen(d_null_mat)
View(G_null_mat)
length(G_null_mat)
?apply
mat_means <- function(mats) {
n <- length(mats)
mats <- array(unlist(mats), c(8, 8, n))
rowMeans(mats, dims = 2)
}
mat_se <- function(mats) {
m <- length(mats)
mats <- array(unlist(mats), c(8, 8, m))
apply(mats, 1:2, std.error)
}
rm(mat_means)
mat_mean <- function(mats) {
n <- length(mats)
mats <- array(unlist(mats), c(8, 8, n))
rowMeans(mats, dims = 2)
}
mat_mean(G_null_mat)
mat_se(G_null_mat)
isSymmetric(mat_se(G_null_mat))
isSymmetric(mat_mean(G_null_mat))
View(d_null_mat)
G_null_mat_mi2 <- mat_gen(d_null_mat[1:3,])
G_null_mat_mi6 <- mat_gen(d_null_mat[4:6,])
G_null_mat_mi8 <- mat_gen(d_null_mat[7:9,])
G_null_mat_mi2 <- mat_mean(mat_gen(d_null_mat[1:3,]))
G_null_mat_mi6 <- mat_mean(mat_gen(d_null_mat[4:6,]))
G_null_mat_mi8 <- mat_mean(mat_gen(d_null_mat[7:9,]))
library(evolqg)
install.packages("evol.qg")
library(devtools)
install_github("lem-usp/evolqg")
install_github("lem-usp/evolqg")
install.packages("evolqg")
install.packages("evolqg")
library(evolqg)
G_null_mat <- array(data = c(G_null_mat_mi2, G_null_mat_mi6, G_null_mat_mi8), c(8, 8, 3))
G_null_mat <- array(data = c(G_null_mat_mi2, G_null_mat_mi6, G_null_mat_mi8))
G_null_mat
G_null_mat <- array(data = c(G_null_mat_mi2, G_null_mat_mi6, G_null_mat_mi8), c(8, 8, 3))
G_null_mat <- array(data = c(G_null_mat_mi2, G_null_mat_mi6, G_null_mat_mi8), c(8, 8, 3))
G_null_mat
EigenTensorDecomposition(G_null_mat)
RandomSkewers(G_null_mat)
RandomSkewers(as.list(G_null_mat))
RandomSkewers(as.List(G_null_mat))
RandomSkewers(c(G_null_mat_mi2, G_null_mat_mi6, G_null_mat_mi8))
RandomSkewers(list(G_null_mat_mi2, G_null_mat_mi6, G_null_mat_mi8))
list(G_null_mat)
RandomSkewers(list(G_null_mat))
G_null_mat <- list(data = c(G_null_mat_mi2, G_null_mat_mi6, G_null_mat_mi8))
EigenTensorDecomposition(G_null_mat)
G_null_mat <- list(data = c(G_null_mat_mi2, G_null_mat_mi6, G_null_mat_mi8))
RandomSkewers(G_null_mat)
G_null_mat <- list(G_null_mat_mi2, G_null_mat_mi6, G_null_mat_mi8)
RandomSkewers(G_null_mat)
RandomSkewers(G_null_mat)
G_null_mat <- list(G_null_mat_mi2, G_null_mat_mi6, G_null_mat_mi8)
RandomSkewers(G_null_mat)
G_null_mat <- list(G_null_mat_mi2, G_null_mat_mi6, G_null_mat_mi8)
RandomSkewers(G_null_mat)
RandomSkewers(G_null_mat)
RandomSkewers(G_null_mat)
